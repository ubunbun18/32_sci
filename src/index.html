<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGPU Monte Carlo π | Extreme Optimization</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div id="app">
        <canvas id="gpu-canvas"></canvas>

        <!-- Stats Panel -->
        <div class="overlay-panel stats-panel">
            <div class="stat-row">
                <span class="label">ESTIMATED π</span>
                <span class="value accent-cyan" id="val-pi">3.14159...</span>
            </div>
            <div class="stat-row">
                <span class="label">ERROR</span>
                <span class="value accent-magenta" id="val-error">0.0000000</span>
            </div>
            <div class="stat-row">
                <span class="label">TOTAL SAMPLES</span>
                <span class="value" id="val-samples">0</span>
            </div>
            <div class="stat-row">
                <span class="label">SPEED</span>
                <span class="value" id="val-speed">0 M/sec</span>
            </div>
            <div class="stat-row">
                <span class="label">FPS</span>
                <span class="value" id="val-fps">60</span>
            </div>
        </div>

        <!-- Verification Deck -->
        <div class="overlay-panel verification-deck">
            <div class="header">VERIFICATION</div>
            <div class="verify-item">
                <span class="status-indicator" id="status-gpu">●</span>
                <span>WebGPU (f16/int-only)</span>
            </div>
            <div class="verify-item">
                <span class="status-indicator pending" id="status-match">●</span>
                <span>CPU-GPU Bit-Match</span>
            </div>
            <div class="button-group">
                <button id="btn-verify" class="btn-verify">RUN VERIFY</button>
                <button id="btn-benchmark" class="btn-verify btn-benchmark">GPU 1B BENCH</button>
            </div>
            <div class="button-group">
                <button id="btn-cpu-bench" class="btn-verify btn-cpu">CPU BENCH (1s)</button>
            </div>
        </div>

        <!-- Chart Container -->
        <div class="chart-container">
            <canvas id="chart-canvas"></canvas>
        </div>

        <!-- Control Deck -->
        <div class="control-deck">
            <div class="control-group">
                <button id="btn-play-pause" class="btn-icon">
                    <svg id="icon-pause" viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                    </svg>
                    <svg id="icon-play" viewBox="0 0 24 24" width="24" height="24" style="display:none">
                        <path fill="currentColor" d="M8 5v14l11-7z" />
                    </svg>
                </button>
                <button id="btn-reset" class="btn-icon">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor"
                            d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-8 3.58-8 8s3.58 8 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" />
                    </svg>
                </button>
            </div>

            <div class="control-divider"></div>

            <div class="control-group input-group">
                <label>SPEED</label>
                <input type="range" id="slider-speed" min="1" max="100" value="50">
            </div>

            <div class="control-group input-group">
                <label>SEED</label>
                <input type="number" id="input-seed" value="12345" min="0">
            </div>
        </div>

        <!-- Error Modal -->
        <div id="error-modal" class="modal hidden">
            <div class="modal-content">
                <h2>WebGPU Not Supported</h2>
                <p>Your browser does not support WebGPU or the required features (shader-f16).</p>
                <p>Please use Chrome Canary or enabled browser.</p>
            </div>
        </div>
        <!-- Scientific Deep Dive Report Modal -->
        <div id="report-modal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center p-4">
            <div class="modal-backdrop absolute inset-0 bg-black/80 backdrop-blur-md"></div>
            <div
                class="modal-content relative w-full max-w-4xl max-h-[90vh] overflow-y-auto bg-gray-900 border border-purple-500/30 rounded-2xl p-8 shadow-2xl">
                <div class="flex justify-between items-center mb-6">
                    <h2
                        class="text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent">
                        Scientific Deep Dive Report</h2>
                    <button id="close-report" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <!-- HPC Metrics -->
                    <div class="bg-gray-800/50 p-6 rounded-xl border border-white/5">
                        <h3 class="text-xl font-semibold mb-4 text-purple-300">HPC Performance Metrics</h3>
                        <div id="report-metrics" class="space-y-4 font-mono text-sm">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                    <!-- Theoretical Convergence Graph -->
                    <div class="bg-gray-800/50 p-6 rounded-xl border border-white/5">
                        <h3 class="text-xl font-semibold mb-4 text-pink-300">Error Convergence Rate</h3>
                        <div id="convergence-status" class="text-sm text-gray-400 mb-2">Steady State ($O(1/\sqrt{N})$
                            Analysis)</div>
                        <canvas id="convergence-chart" height="200"></canvas>
                    </div>
                </div>

                <div class="bg-gray-800/50 p-6 rounded-xl border border-white/5 mb-8">
                    <h3 class="text-xl font-semibold mb-4 text-blue-300">Scientific Analysis & Accuracy</h3>
                    <div id="statistical-report" class="font-mono text-sm text-gray-300">
                        <!-- Filled by JS -->
                    </div>
                </div>

                <div class="flex justify-end gap-1 gap-4">
                    <button id="btn-copy-report"
                        class="px-6 py-2 bg-purple-600 hover:bg-purple-500 rounded-lg transition-all font-semibold">Copy
                        Academic Report</button>
                </div>
            </div>
        </div>
    </div>
    <script type="module" src="main.js"></script>
</body>

</html>